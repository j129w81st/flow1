<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Interactive Cannabis Flowchart</title>

  <!-- 1) Mermaid -->
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>

  <!-- 2) Styles -->
  <style>
    html, body { margin:0; padding:0; height:100%; overflow:hidden; background:#000; }
    #flow-widget {
      display:grid;
      grid-template-columns:auto 1fr 320px;
      height:100vh;
    }
    .zoom-pad {
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:.5rem;
      background:#000;
    }
    .zoom-pad button {
      background:#fff;
      border:none;
      padding:.5rem 1rem;
      font-size:1rem;
      cursor:pointer;
    }
    .board {
      background:#fff;
      position:relative;
      overflow:hidden;
      display:flex;
      justify-content:center;
      align-items:center;
    }
    /* SVG gets these IDs at runtime */
    #canvas { transform-origin:0 0; }
    #canvas.grab { cursor:grab; }
    #canvas.grabbing { cursor:grabbing; }

    #info {
      background:#fff;
      padding:1rem;
      overflow-y:auto;
    }
    #info h2 { margin-top:0; }
  </style>

  <!-- 3) JS: mermaid init, zoom/pan & info -->
  <script>
    document.addEventListener('DOMContentLoaded',()=>{
      // Mermaid
      mermaid.initialize({ startOnLoad:true, securityLevel:'loose', flowchart:{ htmlLabels:true } });
      window.mermaid.parseError = e=>console.error('Mermaid parse error ‚Üí',e);

      // Zoom/Pan
      let s=1, ox=0, oy=0, drag=false, sx, sy;
      window.zoomIn=()=>{ s*=1.2; apply(); };
      window.zoomOut=()=>{ s/=1.2; apply(); };
      window.resetZoom=()=>{ s=1; ox=oy=0; apply(); };
      function apply(){
        const c=document.getElementById('canvas');
        if(c) c.style.transform=`translate(${ox}px,${oy}px) scale(${s})`;
      }
      // After SVG renders, hook mouse events
      setTimeout(()=>{
        const svg=document.querySelector('.mermaid svg');
        if(!svg) return;
        svg.id='canvas';
        svg.classList.add('grab');
        svg.addEventListener('mousedown',e=>{
          drag=true;
          sx=e.clientX-ox;
          sy=e.clientY-oy;
          svg.classList.add('grabbing');
        });
        svg.addEventListener('mousemove',e=>{
          if(!drag) return;
          ox=e.clientX - sx;
          oy=e.clientY - sy;
          apply();
        });
        ['mouseup','mouseleave'].forEach(ev=>
          svg.addEventListener(ev,()=>{
            drag=false;
            svg.classList.remove('grabbing');
          })
        );
      },200);

      // Info map & callback
      const infoMap = {
        A:['Live Cannabis Plant','Living plant with cannabinoids & terpenes‚Ä¶'],
        B1:['Cut & Freeze','Harvest and flash-freeze‚Ä¶'],
        B2:['Dry/Cure Path','Traditional workflow:‚Ä¶'],
        B3:['Dry-sift Path','Material destined for kief‚Ä¶'],
        C1:['Fresh Frozen','Sub-zero storage locks in aroma‚Ä¶'],
        D1:['Ice-water Hash','‚Ä¶'],
        /* ‚Ä¶ copy in all your other entries exactly ‚Ä¶ */
        X3:['Waste','Spent biomass discarded or composted.']
      };
      window.showInfo = id => {
        if(!infoMap[id]) return;
        document.getElementById('title').textContent = infoMap[id][0];
        document.getElementById('body').textContent  = infoMap[id][1];
      };
    });
  </script>
</head>

<body>
  <div id="flow-widget">
    <div class="zoom-pad">
      <button onclick="zoomIn()">‚ûï Zoom In</button>
      <button onclick="zoomOut()">‚ûñ Zoom Out</button>
      <button onclick="resetZoom()">üîÑ Reset</button>
    </div>

    <div class="board">
      <pre class="mermaid">
flowchart LR
  %% ‚îÄ‚îÄ‚îÄ ROOT
  A((üåø Live Cannabis Plant))
    A --> B1["‚ùÑÔ∏è Cut & Freeze"]
    A --> B2["üå¨Ô∏è Cut / Trim / Dry / Cure"]
    A --> B3["üîÅ Cut & Sift"]

  %% ‚îÄ‚îÄ‚îÄ FRESH-FROZEN
    B1 --> C1["ü•∂ Fresh Frozen Plant"]
    C1 --> D1["üßä Ice Water Extraction"]
    C1 --> D2["üí• Hydrocarbon Extraction"]
    C1 --> D3["üß™ CO‚ÇÇ Extraction"]
    C1 --> D4["üç∏ Ethanol Extraction"]
    D1 --> E1["üíß Bubble Hash"]
    E1 --> F1["üå¨Ô∏è Dry Hash"]
    F1 --> G1["‚ú® Bubble Hash (dry)"]
    G1 --> H1["‚è© Use or Press"]
    H1 --> I1["üî• Press ‚Üí Rosin"]
    H1 --> I2["üß± Press ‚Üí Hashish"]
    I1 --> J1["üíé Live Rosin"]
    I2 --> J2["üî∏ Hash Block"]
    D2 --> L1["üß™ Live Resin"]
    L1 --> L2["üî• Purge"]
    L2 --> L3["üí® Resin Vape"]
    L1 --> L4["‚è≥ Crystalize"]
    L4 --> L5["üí† THCA Diamonds"]
    L4 --> L6["üíß Terp Sauce"]
    D3 --> M1["üí• Crude CO‚ÇÇ Oil"]
    M1 --> M2["üå∫ Capture Terpenes"]
    M1 --> M3["üßä Winterize"]
    M3 --> M4["üßº Refined Oil"]
    M4 --> M5["üî¨ Distill"]
    M5 --> M6["üèÅ THC Distillate"]
    M6 --> V1["üõ†Ô∏è Vape"]
    M6 --> V2["üç¨ Edibles"]
    M6 --> V3["üíä Capsules"]
    M6 --> V4["üß¥ Topicals"]
    M2 --> Y1["üåº Terpenes"]
    Y1 --> V1
    D4 --> N1["üß™ Crude Ethanol"]
    N1 --> N2["‚ùÑÔ∏è Winterize"]
    N2 --> N3["üßº Refined"]
    N3 --> N4["üî• Decarb"]
    N4 --> N5["üåà Full Spectrum"]
    N5 --> V2
    N5 --> V3
    N3 --> N6["üî¨ Distill"]
    N6 --> N7["üèÅ Distillate"]
    N7 --> V1
    N7 --> V2
    N7 --> V3
    N7 --> V4

  %% ‚îÄ‚îÄ‚îÄ DRIED-FLOWER
    B2 --> P1["üçÉ Remove Leaves"]
    P1 --> P2["ü™± Compost"]
    P1 --> P3["üí® Hang Dry"]
    P3 --> P4["‚úÇÔ∏è Trim"]
    P4 --> P5["ü´ô Cure"]
    P5 --> P6["üå∏ Cured Flower"]
    P6 --> Q1["üö¨ Flower"]
    P6 --> Q2["üì¶ Pre-roll"]
    P6 --> Q3["üî• Press Rosin"]
    Q3 --> R1["üíé Rosin"]
    P6 --> Q4["ü™∫ Sift ‚Üí Kief"]
    Q4 --> R2["üåø Kief"]
    R2 --> S1["Loose"]
    R2 --> S2["Press"]
    S2 --> R1
    P6 --> Q5["üß™ Solvent Extract"]
    Q5 --> R3["üí• BHO"]
    Q5 --> R4["üß™ Crude Oil"]
    R4 --> R5["üßä Winterize"]
    R5 --> R6["üßº Refined"]
    R6 --> R7["üî¨ Distill"]
    R7 --> R8["üèÅ Distillate"]
    R8 --> V1
    R8 --> V2
    R8 --> V3
    R8 --> V4
    P6 --> Q6["üî• Decarb"]
    Q6 --> Q7["üçØ Infuse Oil"]
    Q7 --> V2
    Q7 --> V3
    Q7 --> V4

  %% ‚îÄ‚îÄ‚îÄ DRY-SIFT
    B3 --> S10["üß∫ Dry Sift"]
    S10 --> S11["üåø Kief"]
    S11 --> S1
    S11 --> S2
    S10 --> X3["üóëÔ∏è Waste"]

  %% ‚îÄ‚îÄ‚îÄ CLICK EVENTS (no ‚Äúcallback‚Äù keyword!)
    click A  showInfo
    click B1 showInfo
    click B2 showInfo
    click B3 showInfo
    click C1 showInfo
    click D1 showInfo
    click D2 showInfo
    click D3 showInfo
    click D4 showInfo
    click E1 showInfo
    click F1 showInfo
    click G1 showInfo
    click H1 showInfo
    click I1 showInfo
    click I2 showInfo
    click J1 showInfo
    click J2 showInfo
    click L1 showInfo
    click L2 showInfo
    click L3 showInfo
    click L4 showInfo
    click L5 showInfo
    click L6 showInfo
    click M1 showInfo
    click M2 showInfo
    click M3 showInfo
    click M4 showInfo
    click M5 showInfo
    click M6 showInfo
    click V1 showInfo
    click V2 showInfo
    click V3 showInfo
    click V4 showInfo
    click Y1 showInfo
    click N1 showInfo
    click N2 showInfo
    click N3 showInfo
    click N4 showInfo
    click N5 showInfo
    click N6 showInfo
    click N7 showInfo
    click P1 showInfo
    click P2 showInfo
    click P3 showInfo
    click P4 showInfo
    click P5 showInfo
    click P6 showInfo
    click Q1 showInfo
    click Q2 showInfo
    click Q3 showInfo
    click R1 showInfo
    click Q4 showInfo
    click R2 showInfo
    click S1 showInfo
    click S2 showInfo
    click R3 showInfo
    click R4 showInfo
    click R5 showInfo
    click R6 showInfo
    click R7 showInfo
    click R8 showInfo
    click Q5 showInfo
    click Q6 showInfo
    click Q7 showInfo
    click S10 showInfo
    click S11 showInfo
    click X3 showInfo
      </pre>
    </div>

    <div id="info">
      <h2 id="title">Hover or click a step ‚Üí</h2>
      <p id="body">Full explanations appear here.</p>
    </div>
  </div>
</body>
</html>
